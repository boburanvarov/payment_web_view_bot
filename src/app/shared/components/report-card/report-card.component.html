<div class="report-card">


  <!-- Income/Expense Stats -->
  <div class="stats-section">
    <div class="stat-card income-stat">
      <div class="stat-content">
        <div class="stat-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
            stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 19V5m-7 7l7 7 7-7" />
          </svg>
        </div>
        <span class="stat-label">Kirim</span>
      </div>
      <span class="stat-value">{{ (processedIncome || income) | money }} so'm</span>
    </div>

    <div class="stat-card expense-stat">

      <div class="stat-content">
        <div class="stat-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
            stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 5v14m-7-7l7-7 7 7" />
          </svg>
        </div>
        <span class="stat-label">Chiqim</span>
      </div>
      <span class="stat-value">{{ (processedExpenses || expenses) | money }} so'm</span>
    </div>
  </div>

  <!-- Filter Buttons -->
  <div class="filter-section" *ngIf="showFilters">
    <button class="filter-btn" [class.active]="showTransactionTypeModal || isFilterActive()"
      (click)="openTransactionTypeModal()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round">
        <path d="M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01" />
      </svg>
      Amaliyotlar
    </button>
    <button class="filter-btn">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
        <path d="M16 2v4M8 2v4M3 10h18" />
      </svg>
      Davr
    </button>
    <button class="filter-btn">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round">
        <rect x="1" y="4" width="22" height="16" rx="2" ry="2" />
        <path d="M1 10h22" />
      </svg>
      Kartalar va hisob raqamlar
    </button>
  </div>

  <!-- Transaction Type Modal -->
  <div class="modal-overlay" *ngIf="showTransactionTypeModal" (click)="closeTransactionTypeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3 class="modal-title">Amaliyotlar turi</h3>
        <button class="modal-close-btn" (click)="closeTransactionTypeModal()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 6L6 18M6 6l12 12" />
          </svg>
        </button>
      </div>

      <div class="modal-body">
        <div class="radio-group">
          <label class="radio-option" *ngFor="let option of filterOptions">
            <span class="radio-label">{{ option.label }}</span>
            <input type="radio" name="transactionType" [value]="option.value" [(ngModel)]="tempSelectedFilterType"
              class="radio-input">
            <span class="radio-custom"></span>
          </label>
        </div>
      </div>

      <div class="modal-footer">
        <button class="apply-btn" (click)="applyTransactionFilter()">Saralash</button>
      </div>
    </div>
  </div>


  <!-- Transactions -->
  <div class="transactions-section">
    <div class="section-header">
      <h3 class="section-title">So'ngi tranzaksiyalar</h3>
      <button class="see-all-btn" *ngIf="showSeeAll" (click)="onSeeAllClick()">Barchasi</button>
    </div>

    <div class="transactions-container" [class.limited-transactions]="maxTransactions">
      <div class="date-group" *ngFor="let group of groupedTransactions">
        <div class="date-header">{{ group.date }}</div>

        <div class="transaction-item" *ngFor="let transaction of group.transactions">
          <!-- Top row: Chiqim/Kirim and Time -->
          <div class="transaction-top-row">
            <div class="transaction-type" [ngClass]="transaction.type === 'income' ? 'income-type' : 'expense-type'">
              <div class="transaction-dot"></div>
              <span>{{ transaction.type === 'income' ? 'Kirim' : 'Chiqim' }}</span>
            </div>
            <div class="transaction-time">{{ transaction.time }}</div>
          </div>

          <!-- Bottom row: Card logo/number and Amount -->
          <div class="transaction-bottom-row">
            <div class="transaction-card">
              <img *ngIf="transaction.processingLogoMini" [src]="transaction.processingLogoMini" alt="Card"
                class="card-icon" width="16" height="16" />
              <svg *ngIf="!transaction.processingLogoMini" width="16" height="16" viewBox="0 0 24 24" fill="none"
                class="card-icon">
                <circle cx="12" cy="12" r="10" fill="#2563EB" />
                <text x="12" y="16" text-anchor="middle" fill="white" font-size="10" font-weight="bold">U</text>
              </svg>
              <span>{{ transaction.cardNumber }}</span>
            </div>
            <div class="transaction-amount" [ngClass]="transaction.type === 'income' ? 'positive' : 'negative'">
              {{ transaction.amount > 0 ? '+' : '' }}{{ getAbsoluteValue(transaction.amount) | money }}<span
                *ngIf="transaction.type === 'income'"> so'm</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>